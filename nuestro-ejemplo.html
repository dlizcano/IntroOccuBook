<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Simulación y analisis de ocupación</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is an R example to get occupancy data and analize it.">
  <meta name="generator" content="bookdown 0.1 and GitBook 2.6.7">

  <meta property="og:title" content="Simulación y analisis de ocupación" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an R example to get occupancy data and analize it." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Simulación y analisis de ocupación" />
  
  <meta name="twitter:description" content="This is an R example to get occupancy data and analize it." />
  

<meta name="author" content="Diego J. Lizcano">

<meta name="date" content="2016-07-24">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="la-ocupacion-de-habitat.html">
<link rel="next" href="empacando-todo-en-una-funcion-.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulando datos de ocupación</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="porque-simular.html"><a href="porque-simular.html"><i class="fa fa-check"></i><b>3</b> Porque simular?</a><ul>
<li class="chapter" data-level="3.1" data-path="porque-simular.html"><a href="porque-simular.html#por-que-son-utiles-las-simulaciones"><i class="fa fa-check"></i><b>3.1</b> Por que son útiles las simulaciones:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="la-ocupacion-de-habitat.html"><a href="la-ocupacion-de-habitat.html"><i class="fa fa-check"></i><b>4</b> La ocupación de hábitat</a></li>
<li class="chapter" data-level="5" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html"><i class="fa fa-check"></i><b>5</b> Nuestro ejemplo:</a><ul>
<li class="chapter" data-level="5.0.1" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#modelo-ecologico"><i class="fa fa-check"></i><b>5.0.1</b> Modelo Ecológico:</a></li>
<li class="chapter" data-level="5.0.2" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#modelo-de-observacion"><i class="fa fa-check"></i><b>5.0.2</b> Modelo de Observación:</a></li>
<li class="chapter" data-level="5.1" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#pasos-iniciales-tamano-de-la-muestra-y-valores-de-las-co-variables"><i class="fa fa-check"></i><b>5.1</b> Pasos iniciales: tamaño de la muestra y valores de las co-variables</a></li>
<li class="chapter" data-level="5.2" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#simulando-el-proceso-ecologico-y-su-resultado-la-ocurrencia-del-venado"><i class="fa fa-check"></i><b>5.2</b> Simulando el proceso ecológico y su resultado: la ocurrencia del venado</a><ul>
<li class="chapter" data-level="5.2.1" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#por-que-bernoulli"><i class="fa fa-check"></i><b>5.2.1</b> Por que Bernoulli?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#simulando-el-proceso-de-observacion-y-su-resultado-la-deteccion"><i class="fa fa-check"></i><b>5.3</b> Simulando el proceso de observación y su resultado: la detección</a><ul>
<li class="chapter" data-level="5.3.1" data-path="nuestro-ejemplo.html"><a href="nuestro-ejemplo.html#uniendo-los-dos-procesos-el-ecologico-y-el-de-observacion"><i class="fa fa-check"></i><b>5.3.1</b> Uniendo los dos procesos el ecologico y el de observación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="empacando-todo-en-una-funcion-.html"><a href="empacando-todo-en-una-funcion-.html"><i class="fa fa-check"></i><b>6</b> Empacando todo en una función.</a></li>
<li class="chapter" data-level="7" data-path="analisis-de-ocupacion-metodo-ml.html"><a href="analisis-de-ocupacion-metodo-ml.html"><i class="fa fa-check"></i><b>7</b> Analisis de ocupación, metodo ML</a><ul>
<li class="chapter" data-level="7.1" data-path="analisis-de-ocupacion-metodo-ml.html"><a href="analisis-de-ocupacion-metodo-ml.html#generando-los-datos"><i class="fa fa-check"></i><b>7.1</b> Generando los datos</a></li>
<li class="chapter" data-level="7.2" data-path="analisis-de-ocupacion-metodo-ml.html"><a href="analisis-de-ocupacion-metodo-ml.html#poniendo-los-datos-en-unmarked"><i class="fa fa-check"></i><b>7.2</b> Poniendo los datos en unmarked</a></li>
<li class="chapter" data-level="7.3" data-path="analisis-de-ocupacion-metodo-ml.html"><a href="analisis-de-ocupacion-metodo-ml.html#ajustando-los-modelos"><i class="fa fa-check"></i><b>7.3</b> Ajustando los modelos</a></li>
<li class="chapter" data-level="7.4" data-path="analisis-de-ocupacion-metodo-ml.html"><a href="analisis-de-ocupacion-metodo-ml.html#model-selection"><i class="fa fa-check"></i><b>7.4</b> Model selection</a></li>
<li class="chapter" data-level="7.5" data-path="analisis-de-ocupacion-metodo-ml.html"><a href="analisis-de-ocupacion-metodo-ml.html#prediccion-en-graficas-y-mapas"><i class="fa fa-check"></i><b>7.5</b> Predicción en graficas y mapas</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analisis-bayesiano.html"><a href="analisis-bayesiano.html"><i class="fa fa-check"></i><b>8</b> Análisis Bayesiano</a><ul>
<li class="chapter" data-level="8.1" data-path="analisis-bayesiano.html"><a href="analisis-bayesiano.html#generando-los-datos-1"><i class="fa fa-check"></i><b>8.1</b> Generando los datos</a></li>
<li class="chapter" data-level="8.2" data-path="analisis-bayesiano.html"><a href="analisis-bayesiano.html#comparando-los-valores-reales-y-los-estimados-de-ml-y-bayesiano"><i class="fa fa-check"></i><b>8.2</b> Comparando los valores reales y los estimados de ML y Bayesiano</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="informacion-de-la-session-de-r-y-los-paquetes-usados.html"><a href="informacion-de-la-session-de-r-y-los-paquetes-usados.html"><i class="fa fa-check"></i><b>9</b> Información de la sessión de R y los paquetes usados</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación y analisis de ocupación</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nuestro-ejemplo" class="section level1">
<h1><span class="header-section-number">Capitulo 5</span> Nuestro ejemplo:</h1>
<p>El set de datos que vamos a simular, imita la forma espacial y temporal como imaginamos se originan las medidas repetidas de presencia ausencia en ecología. Las cuales son una combinación de un proceso ecológico y un proceso de observación. El primer proceso contiene los mecanismos bajos los cuales se originan patrones espacio-temporales de distribución, mientras que el segundo proceso contiene las diferentes facetas en las cuales se originan fuentes de error al tomar los datos.</p>
<p>Para ser más concretos vamos a llamar a nuestra especie imaginaria con un nombre real. La llamaremos el venado de cola blanca (<em>Odocoileus virginianus</em>), un mamífero grande y común, ampliamente distribuido en el continente Americano, y de preocupación menor en términos de <a href="http://www.iucnredlist.org/details/42394">conservación</a>.</p>
<p><img src="http://static.inaturalist.org/photos/1305358/large.JPG?1414422110" alt="Venado de cola blanca" /> El Venado de cola blanca (<em>Odocoileus virginianus</em>) nuestra especie de interes para este ejemplo. Foto del proyecto fauna de Manabi <a href="http://faunamanabi.github.io" class="uri">http://faunamanabi.github.io</a></p>
<p>El set de datos contiene <em>J</em> datos replicados de detección o no detección de la especie en <em>M</em> sitios, teniendo en cuenta que asumimos que es una población cerrada (‘closure’ assumption). Es decir que durante el muestreo no ocurrieron cambios por nacimientos, muertes inmigración o emigración. En otras palabras, el muestreo fue corto en tiempo y la ocurrencia de la especie <em>z</em> no cambió por efectos demográficos.</p>
<p>Claramente debemos distinguir dos procesos, el primero es el proceso ecológico, el cual genera (parcialmente) un estado latente de la ocurrencia <em>z</em>. El segundo es el proceso de observación, el cual produce los datos observados de detección o no detección del venado. Aquí asumimos que el proceso de observación está gobernado por un mecanismo de detección imperfecta. Es decir algunos venado pudieron haberse escapado a mi observación, lo cual genera falsos negativos. También asumimos que los falsos positivos están ausentes, es decir que todo lo que identifico como venado, es efectivamente un venado. Para hacer más realista el ejemplo incluimos los efectos de la altitud y la cobertura de bosque en la ocurrencia, como factores que afectan la ocurrencia linealmente, disminuyendola para el caso de la elevación y que incrementan la ocupación linealmente para el caso de la cobertura de bosques. Al final las dos variables interactúan negativamente entre sí. Esos efectos se introducen en la ocurrencia en escala logarítmica como tradicionalmente se hace un modelo lineal generalizado (GLM).</p>
<p>En nuestra simulación vamos a hacer explícito que no es posible detectar a la totalidad de los venados de un sitio de muestreo, así que estamos enfrentando un tipo de error que nos hace sub-estimar la abundancia de la población. Hay muchas razónes por las cuales fallamos en detectar un individuo en la naturaleza, porque nos distrajimos mientras el venado paso, porque los binoculares no tenían el aumento suficiente, o simplemente porque el venado se escondió detrás de un árbol al sentir nuestro olor, o por alguna otra razón. De esta forma nosotros vamos a registrar la presencia (<em>z</em>=1) con una probabilidad de detección <em>p</em> la cual también vamos a hacerla dependiente (en la escala logarítmica) de la altitud y de una co-variable que afecta la detección, la temperatura. En términos generales los animales son más difíciles de observar cuando la temperatura es mas alta y por lo general entre más altitud la temperatura disminuye. De esta forma asumimos que la detección está relacionada negativamente con a con la altitud y la temperatura. Pero también hay que tener en cuenta que el efecto negativo en <em>p</em> también puede ser mediado por una disminución en la abundancia con la altitud, el cual también causa que la probabilidad de ocupación disminuya con la altitud. Tenga en cuenta que una co-variable, la altitud afecta a ambos procesos, el ecológico (la ocurrencia) y al proceso de observación (la probabilidad de detección). Esto tiene un propósito, y es probable que pase en la naturaleza muchas veces. Los modelos de ocupación tienen una base “mecanistica” produciendo variación espacial en la abundancia. Es decir tendremos sitios con mayor abundancia y otros con menor abundancia. Pero los modelos jerárquicos como el que estamos por construir, son capaces de desentrañar esas relaciones complejas entre ocurrencia y probabilidad de detección <span class="citation">(M. Kéry and Royle <a href="#ref-Kery2008">2008</a>; M. Kéry <a href="#ref-KERY2008">2008</a>; Kéry and Schaub <a href="#ref-Kery2012">2012</a>)</span>. Finalmente para este primer ejemplo vamos a dejar por fuera el efecto de la interacción entre la altitud y la temperatura, ajustándolo a cero. Luego podremos variar este parámetro para considerar ese efecto. En resumen vamos a generar datos bajo el siguiente modelo, donde los sitios son indexados como <em>i</em> y los conteos repetidos en el sitio van a ser referidos como <em>j</em>.</p>
<div id="modelo-ecologico" class="section level3">
<h3><span class="header-section-number">5.0.1</span> Modelo Ecológico:</h3>
<p><span class="math inline">\(z _{i} = Bernoulli (\psi _{i})\)</span></p>
<p><span class="math inline">\(logit(\psi _{i}) = \beta _{0} + \beta _{1} \ast Altitud _{i} + \beta _{2}\ast CovBosque _{i} + \beta _{3} \ast Altitud _{i} \ast CovBosque _{i}\)</span></p>
</div>
<div id="modelo-de-observacion" class="section level3">
<h3><span class="header-section-number">5.0.2</span> Modelo de Observación:</h3>
<p><span class="math inline">\(y _{ij} = Bernoulli (z _{i} * p _{ij})\)</span></p>
<p><span class="math inline">\(logit(p _{ij}) = \alpha _{0} + \alpha _{1} \ast Altitud _{i} + \alpha _{2}\ast Temperatura _{ij} + \alpha _{3} \ast Altitud _{i} \ast Temperatura _{ij}\)</span></p>
<p>Donde <span class="math inline">\(\psi\)</span> es la ocupación y <em>p</em> la probabilidad de detección. Con <span class="math inline">\(\beta\)</span> como el coeficiente de la regresión para las co-variables de la ocupación y <span class="math inline">\(\alpha\)</span> el coeficiente de regresión para las co-variables de la detección.</p>
<p>Vamos a generar datos desde “dentro hacia afuera” y desde arriba hacia abajo. Para esto, primero escogemos el tamaño de la muestra y creamos los valores para las co-variables. Segundo, seleccionamos los valores de los parámetros de del modelo ecológico (la ocupación) y ensamblamos la ocurrencia esperada (el parámetro <span class="math inline">\(\psi\)</span>, o la ocupación) y posteriormente obtenemos la variable al azar <em>z</em> la cual tiene distribución Bernoulli. Tercero, seleccionamos los valores de los parámetros del modelo de observación (la detección), para ensamblar la probabilidad de detección <em>p</em> y obtener el segundo set de una variable al azar <em>y</em> (detección observada o no observada de un venado) la cual también tiene distribución Bernoulli.</p>
<p>Para simular los datos usaremos el lenguaje de programación estadística R <span class="citation">(R Core Team <a href="#ref-RCoreTeam2016">2016</a>)</span>, el cual provee una gran variedad de técnicas gráficas y estadísticas de modelación y un gran ecosistema de paquetes para análisis estadístico y ecológico. Si aún no lo ha hecho, baje e instale <a href="http://www.r-project.org/">R</a> en su computadora, posteriormente haga lo mismo con <a href="http://www.rstudio.com/">RStudio.</a></p>
</div>
<div id="pasos-iniciales-tamano-de-la-muestra-y-valores-de-las-co-variables" class="section level2">
<h2><span class="header-section-number">5.1</span> Pasos iniciales: tamaño de la muestra y valores de las co-variables</h2>
<p>Inicie <a href="http://www.rstudio.com/">RStudio</a>, copie, pegue y ejecute los comandos de la ventana gris.</p>
<p>Primero escogemos el tamaño de la muestra, el número de sitios y el número de medidas repetidas (número de visitas) de presencia/ausencia en cada sitio.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M &lt;-<span class="st"> </span><span class="dv">60</span>  <span class="co"># Número de réplicas espaciales (sitios)</span>
J &lt;-<span class="st"> </span><span class="dv">30</span>  <span class="co"># Número de réplicas temporales (conteos repetidos)</span></code></pre></div>
<p>Luego creamos los valores para las co-variables. Tenemos altitud y cobertura de bosque como co-variables de cada sitio. Ellas difieren de sitio a sitio pero para cada muestreo son las mismas. Mientras que la temperatura es una co-variable de la observación, así que si varía en cada muestreo y también en cada sitio. Recuerde que el sub índice <em>i</em> se refiere al sitio y el <em>j</em> a cada muestreo. Para simplificar las cosas nuestras co-variables van a tener una distribución normal con una media centrada en cero y no se van a extender muy lejos en cada lado del cero. En análisis de datos reales tendremos que estandarizar las co-variables para evitar problemas numéricos de diferencia en las escalas de las co-variables y poder calcular el valor de máxima verosimilitud (ML), así como también para obtener convergencia en las cadenas de Markov del modelo Bayesiano. Aquí vamos a ignorar un hecho de la vida real, y es que las co-variables no son totalmente independientes la una de la otra, es decir en la naturaleza la cobertura boscosa puede estar relacionada con la altitud, pero esto no va a ser relevante, por ahora.</p>
<p>Para inicializar el generador de números aleatorios y obtener siempre los mismos resultados podemos adicionar la siguiente línea:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">24</span>) <span class="co"># Can choose seed of your choice</span></code></pre></div>
<p>De esta forma podremos obtener siempre los mismos estimados. Pero luego cuando queramos obtener el error de muestreo deberemos remover esa línea. Para este ejemplo generaremos valores para las covariables centrados en cero y variando de -1 a 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">elev &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> M, -<span class="dv">1</span>, <span class="dv">1</span>)             <span class="co"># Scaled elevation of a site</span>
forest &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> M, -<span class="dv">1</span>, <span class="dv">1</span>)           <span class="co"># Scaled forest cover at each site</span>
temp &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">runif</span>(<span class="dt">n =</span> M*J, -<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">dim =</span> <span class="kw">c</span>(M, J)) <span class="co"># Scaled temperature</span></code></pre></div>
</div>
<div id="simulando-el-proceso-ecologico-y-su-resultado-la-ocurrencia-del-venado" class="section level2">
<h2><span class="header-section-number">5.2</span> Simulando el proceso ecológico y su resultado: la ocurrencia del venado</h2>
<p>Para simular la ocurrencia del venado en cada sitio, escogemos los valores para los parámetros que gobiernan la variación espacial en la ocurrencia <span class="math inline">\(\beta _{0}\)</span> a <span class="math inline">\(\beta _{3}\)</span>. El primer parámetro es la ocurrencia promedio esperada del venado (probabilidad de ocupación) cuando todas las co-variables tienen un valor de cero, en otras palabras el intercepto del modelo de ocurrencia. Preferimos pensar en los venados en términos de su ocurrencia en lugar de logit(ocurrencia). Aquí nosotros escogemos el intercepto de la ocupación primero y luego lo transformamos de la escala logarítmica con la función de enlace logit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean.occupancy &lt;-<span class="st"> </span><span class="fl">0.60</span>         <span class="co"># Mean expected occurrence of deer</span>
beta0 &lt;-<span class="st"> </span><span class="kw">plogis</span>(mean.occupancy) <span class="co"># Same on logit scale (= logit-scale intercept)</span>
beta1 &lt;-<span class="st"> </span>-<span class="dv">2</span>                    <span class="co"># Effect (slope) of elevation</span>
beta2 &lt;-<span class="st"> </span><span class="dv">2</span>                     <span class="co"># Effect (slope) of forest cover</span>
beta3 &lt;-<span class="st"> </span><span class="dv">1</span>                     <span class="co"># Interaction effect (slope) of elev and forest</span></code></pre></div>
<p>Aquí aplicamos el modelo lineal (a la escala logarítmica) y obtenemos la transformación logit de la probabilidad de ocupación, la cual invertimos con la transformación logit para obtener la ocupación del venado y graficar todo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logit.psi &lt;-<span class="st"> </span>beta0 +<span class="st"> </span>beta1 *<span class="st"> </span>elev +<span class="st"> </span>beta2 *<span class="st"> </span>forest +<span class="st"> </span>beta3 *<span class="st"> </span>elev *<span class="st"> </span>forest
psi &lt;-<span class="st"> </span><span class="kw">plogis</span>(logit.psi)      <span class="co"># Inverse link transformation</span>

<span class="co"># par()              # view current settings</span>
opar &lt;-<span class="st"> </span><span class="kw">par</span>()      <span class="co"># make a copy of current settings</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">cex.main =</span> <span class="dv">1</span>)
<span class="kw">curve</span>(<span class="kw">plogis</span>(beta0 +<span class="st"> </span>beta1*x), -<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),
      <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;psi&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">text</span>(<span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="st">&quot;A&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">plot</span>(elev, psi, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">text</span>(<span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="st">&quot;B&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">curve</span>(<span class="kw">plogis</span>(beta0 +<span class="st"> </span>beta2*x), -<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), 
      <span class="dt">xlab =</span> <span class="st">&quot;Forest cover&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;psi&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">text</span>(-<span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="st">&quot;C&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">plot</span>(forest, psi, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlab =</span> <span class="st">&quot;Forest cover&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">text</span>(-<span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="st">&quot;D&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</code></pre></div>
<div class="figure"><span id="fig:graph2"></span>
<img src="Simul-Machalilla-book_files/figure-html/graph2-1.png" alt="Dos formas de mostrar la relación entre la probabilidad de ocurrencia de los venados y las co-variables.  (A) Relación entre psi y altitud para un valor constante (media igual a cero) de cobertura boscosa. (B) Relación entre psi y la altitud en un valor observado de cobertura boscosa. (C) relación psi cobertura boscosa para una altitud constante (en la media de cero). (D) Relación psi cobertura boscosa para el valor observado de altitud." width="672" />
<p class="caption">
Figure 5.1: Dos formas de mostrar la relación entre la probabilidad de ocurrencia de los venados y las co-variables. (A) Relación entre psi y altitud para un valor constante (media igual a cero) de cobertura boscosa. (B) Relación entre psi y la altitud en un valor observado de cobertura boscosa. (C) relación psi cobertura boscosa para una altitud constante (en la media de cero). (D) Relación psi cobertura boscosa para el valor observado de altitud.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dev.off()</span>
<span class="kw">par</span>(opar)          <span class="co"># restore original par settings</span></code></pre></div>
<p>Para mostrar mejor la relación conjunta entre las dos covariables y psi, debemos realizar un diagrama de superficie. Aquí no hemos cambiado nada de la simulación, solo le hemos agregado más datos para visualizar mejor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute expected occurrence for a grid of elevation and forest cover</span>
cov1 &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">1</span>, <span class="dv">1</span>, , <span class="dv">100</span>)                       <span class="co"># Values for elevation</span>
cov2 &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">1</span>, <span class="dv">1</span>, , <span class="dv">100</span>)                       <span class="co"># Values for forest cover</span>
psi.matrix &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">100</span>))      <span class="co"># Prediction matrix, for every </span>
<span class="co"># combination of values of elevation and forest cover</span>

for(i in <span class="dv">1</span>:<span class="dv">100</span>){
   for(j in <span class="dv">1</span>:<span class="dv">100</span>){
      psi.matrix[i, j] &lt;-<span class="st"> </span><span class="kw">plogis</span>(beta0 +<span class="st"> </span>
<span class="st">                                   </span>beta1 *<span class="st"> </span>cov1[i] +<span class="st"> </span>
<span class="st">                                   </span>beta2 *<span class="st"> </span>cov2[j] +<span class="st"> </span>
<span class="st">                                   </span>beta3 *<span class="st"> </span>cov1[i] *<span class="st"> </span>cov2[j] )
   }
}

mapPalette &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>))
<span class="kw">image</span>(<span class="dt">x =</span> cov1, <span class="dt">y =</span> cov2, <span class="dt">z =</span> psi.matrix, <span class="dt">col =</span> <span class="kw">mapPalette</span>(<span class="dv">100</span>), <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, 
      <span class="dt">ylab =</span> <span class="st">&quot;Forest cover&quot;</span>, <span class="dt">cex.lab =</span> <span class="fl">1.2</span>)
<span class="kw">contour</span>(<span class="dt">x =</span> cov1, <span class="dt">y =</span> cov2, <span class="dt">z =</span> psi.matrix, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)
<span class="kw">matpoints</span>(elev, forest, <span class="dt">pch=</span><span class="st">&quot;+&quot;</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)</code></pre></div>
<div class="figure"><span id="fig:gpagh3"></span>
<img src="Simul-Machalilla-book_files/figure-html/gpagh3-1.png" alt="Relación construida ente los datos simulados de la ocurrencia esperada (ocupación) del venado (psi) representada con la escala de color de gris a rojo, contra la altitud y la cobertura boscosa simultáneamente. En este caso la interaccion entre las dos covariables esta dada por el valor de beta3 = 1 que hemos establecido anteriormente." width="672" />
<p class="caption">
Figure 5.2: Relación construida ente los datos simulados de la ocurrencia esperada (ocupación) del venado (psi) representada con la escala de color de gris a rojo, contra la altitud y la cobertura boscosa simultáneamente. En este caso la interaccion entre las dos covariables esta dada por el valor de beta3 = 1 que hemos establecido anteriormente.
</p>
</div>
<p>Hasta ahora no hemos introducido ninguna variación estocástica en la relación entre la ocurrencia del venado y las covariables. Para hacer esto debemos hacer uso de algunos modelos estadísticos o distribuciones estadísticas, para describir la variabilidad al azar alrededor del valor esperado de psi. La forma típica de introducir esta variación al azar es obtener la ocurrencia de venados en cada sitio <em>i</em>, <span class="math inline">\(z _{i}\)</span>, de una distribución Bernoulli con los valores esperados (<span class="math inline">\(\psi _{i}\)</span>).</p>
<div id="por-que-bernoulli" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Por que Bernoulli?</h3>
<p>En el proceso ecologico <span class="math inline">\(z _{i}\)</span> la ocurrencia del venado esta representado por una distribución de tipo Bernoulli donde el venado este presente en un sitio representado como la ocupación <span class="math inline">\(\psi\)</span> en un sitio en que esta presente, o no esta presente 1-<span class="math inline">\(\psi\)</span>. La distribución Bernoulli es un caso especial de la distribución binomial, y su mejor ejemplo es el lanzamiento de una moneda una sola vez. Si requiere una explicación más extensa, básica, detallada y con mas ejemplos le recomiendo visitar <a href="https://es.khanacademy.org/math/probability/statistics-inferential/margin-of-error/v/mean-and-variance-of-bernoulli-distribution-example">khanacademy.</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> M, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> psi)  <span class="co"># Realised occurrence. A Bernoulli</span>
<span class="kw">sum</span>(z)                                    <span class="co"># Total number of occupied sites</span></code></pre></div>
<pre><code>## [1] 40</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(z)                                  <span class="co"># Frequency distribution of deer occurrence</span></code></pre></div>
<pre><code>## z
##  0  1 
## 20 40</code></pre>
<p>Aquí hemos creado el resultado del proceso ecológico: ocurrencia específica para cada sitio <span class="math inline">\(z _{1}\)</span>. Vemos que 23 sitios no están ocupados y que los restantes 37 si están ocupados.</p>
</div>
</div>
<div id="simulando-el-proceso-de-observacion-y-su-resultado-la-deteccion" class="section level2">
<h2><span class="header-section-number">5.3</span> Simulando el proceso de observación y su resultado: la detección</h2>
<p>La ocurrencia <em>z</em> no es lo que normalmente vemos, ya que hay un chance de que fallemos en observar un individuo. De ahí que haya una medida binaria de error cuando medimos la ocurrencia (lo observamos o no lo observamos). Nosotros asumimos que podemos hacer únicamente una de las dos posibles observaciones (si, no), pero pudimos haber perdido la observación de un venado en algún sitio, entonces la probabilidad de detección es menor que uno y la medida de error es afectada por la cobertura de bosque y la temperatura. Hay que tener en cuenta que nunca vamos a registrar la presencia de un venado cuando en realidad no hay venados. En otras palabras estamos asumiendo que no tenemos falsos positivos. Para hacer explícito que tenemos un efecto de interacción entre dos co variables en nuestros datos, vamos a permitir un efecto de la interacción en el código, pero ajustado a cero y de esta forma sin efecto en el modelo que genera los datos. Primero seleccionamos los valores para <span class="math inline">\(\alpha _{0}\)</span> hasta <span class="math inline">\(\alpha _{3}\)</span>, donde el primero es la probabilidad de detección para el venado, en la escala logit, cuando todas las co variables de la detección tienen un valor de cero. Hemos escogido el intercepto del modelo de detección y luego lo transformamos con la función de enlace plogis. Esto no es lo mismo que la probabilidad de detección media, la cual es más alta en nuestro modelo de simulación, como veremos más adelante.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean.detection &lt;-<span class="st"> </span><span class="fl">0.3</span>            <span class="co"># Mean expected detection</span>
alpha0 &lt;-<span class="st"> </span><span class="kw">qlogis</span>(mean.detection) <span class="co"># same on logit scale (intercept)</span>
alpha1 &lt;-<span class="st"> </span>-<span class="dv">1</span>                     <span class="co"># Effect (slope) of elevation</span>
alpha2 &lt;-<span class="st"> </span>-<span class="dv">3</span>                     <span class="co"># Effect (slope) of temperature</span>
alpha3 &lt;-<span class="st"> </span><span class="dv">0</span>                      <span class="co"># Interaction effect (slope) of elevevation and temperature</span></code></pre></div>
<p>Aplicando el modelo lineal, tenemos el logit de la probabilidad de detección del venado para cada sitio y muestreo, y aplicándole la transformación inversa (plogis), obtenemos una matriz de las dimensiones 60 por 30 con la probabilidad de detección para cada sitio <em>i</em> y muestreo <em>j</em>. Finalmente, graficamos las relaciones para la probabilidad de detección en los datos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logit.p &lt;-<span class="st"> </span>alpha0 +<span class="st"> </span>alpha1 *<span class="st"> </span>elev +<span class="st"> </span>alpha2 *<span class="st"> </span>temp +<span class="st"> </span>alpha3 *<span class="st"> </span>elev *<span class="st"> </span>temp
p &lt;-<span class="st"> </span><span class="kw">plogis</span>(logit.p)             <span class="co"># Inverse link transform </span>
<span class="kw">mean</span>(p)                          <span class="co"># average per-site p is about 0.39</span></code></pre></div>
<pre><code>## [1] 0.3928068</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">cex.main =</span> <span class="dv">1</span>)
<span class="kw">curve</span>(<span class="kw">plogis</span>(alpha0 +<span class="st"> </span>alpha1*x), -<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), 
      <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">text</span>(-<span class="fl">0.9</span>, <span class="fl">1.05</span>, <span class="st">&quot;A&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">matplot</span>(elev, p, <span class="dt">pch =</span> <span class="st">&quot;*&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, 
        <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">text</span>(-<span class="fl">0.9</span>, <span class="fl">1.05</span>, <span class="st">&quot;B&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">curve</span>(<span class="kw">plogis</span>(alpha0 +<span class="st"> </span>alpha2*x), -<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), 
      <span class="dt">xlab =</span> <span class="st">&quot;Temperature&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">text</span>(-<span class="fl">0.9</span>, <span class="fl">1.05</span>, <span class="st">&quot;C&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">matplot</span>(temp, p, <span class="dt">pch =</span> <span class="st">&quot;*&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), <span class="dt">xlab =</span> <span class="st">&quot;Temperature&quot;</span>, 
        <span class="dt">ylab =</span> <span class="st">&quot;p&quot;</span>)
<span class="kw">text</span>(-<span class="fl">0.9</span>, <span class="fl">1.05</span>, <span class="st">&quot;D&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</code></pre></div>
<div class="figure"><span id="fig:graph4"></span>
<img src="Simul-Machalilla-book_files/figure-html/graph4-1.png" alt="Dos formas de mostrar las relaciones entre la probabilidad de detección esperada del venado (_p_) y las dos variables altitud y temperatura. (A) Relación _p_ y altitud para temperatura constante (en el valor medio, que es igual a cero). (B) Relación entre _p_ y la altitud en el valor observado de cantidad de temperatura. (C) Relación entre _p_ y temperatura para un valor constante de altitud (en la altitud media igual a cero). (D) Relación entre _p_ y temperatura para un valor observado de altitud." width="672" />
<p class="caption">
Figure 5.3: Dos formas de mostrar las relaciones entre la probabilidad de detección esperada del venado (<em>p</em>) y las dos variables altitud y temperatura. (A) Relación <em>p</em> y altitud para temperatura constante (en el valor medio, que es igual a cero). (B) Relación entre <em>p</em> y la altitud en el valor observado de cantidad de temperatura. (C) Relación entre <em>p</em> y temperatura para un valor constante de altitud (en la altitud media igual a cero). (D) Relación entre <em>p</em> y temperatura para un valor observado de altitud.
</p>
</div>
<p>De forma similar vamos a producir una gráfica de una superficie con la relación conjunta entre la altitud, la temperatura y la probabilidad de detección del venado (<em>p</em>), actuando simultáneamente. La relación en la escala logarítmica es representada por un plano con pendiente que representa la interaccion entre la elevacion y la cobertura de bosque.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute expected detection probability for a grid of elevation and temperature</span>
cov1 &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">1</span>, <span class="dv">1</span>,,<span class="dv">100</span>)                  <span class="co"># Values of elevation</span>
cov2 &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">1</span>,<span class="dv">1</span>,,<span class="dv">100</span>)                   <span class="co"># Values of temperature</span>
p.matrix &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">100</span>)) <span class="co"># Prediction matrix which combines </span>
<span class="co"># every value in cov 1 with every other in cov2</span>
for(i in <span class="dv">1</span>:<span class="dv">100</span>){
   for(j in <span class="dv">1</span>:<span class="dv">100</span>){
      p.matrix[i, j] &lt;-<span class="st"> </span><span class="kw">plogis</span>(alpha0 +<span class="st"> </span>alpha1 *<span class="st"> </span>cov1[i] +<span class="st"> </span>
<span class="st">                                 </span>alpha2 *<span class="st"> </span>cov2[j] +<span class="st"> </span>
<span class="st">                                 </span>alpha3 *<span class="st"> </span>cov1[i] *<span class="st"> </span>cov2[j])
   }
}
<span class="kw">image</span>(<span class="dt">x =</span> cov1, <span class="dt">y =</span> cov2, <span class="dt">z =</span> p.matrix, <span class="dt">col =</span> <span class="kw">mapPalette</span>(<span class="dv">100</span>), <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, 
      <span class="dt">ylab =</span> <span class="st">&quot;Temperature&quot;</span>, <span class="dt">cex.lab =</span> <span class="fl">1.2</span>)
<span class="kw">contour</span>(<span class="dt">x =</span> cov1, <span class="dt">y =</span> cov2, <span class="dt">z =</span> p.matrix, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)
<span class="kw">matpoints</span>(elev, temp, <span class="dt">pch=</span><span class="st">&quot;+&quot;</span>, <span class="dt">cex=</span><span class="fl">0.7</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:graph5"></span>
<img src="Simul-Machalilla-book_files/figure-html/graph5-1.png" alt="Relación construida ente los datos simulados de la probabilidad de deteccion esperada (detectabilidad) del venado (p) representada con la escala de color de gris a rojo, contra la altitud y la temperatura simultáneamente. En este caso la interaccion entre las dos covariables tiene una relacion lineal que esta dada por el valor de alpha3 = 0 que hemos establecido anteriormente." width="672" />
<p class="caption">
Figure 5.4: Relación construida ente los datos simulados de la probabilidad de deteccion esperada (detectabilidad) del venado (p) representada con la escala de color de gris a rojo, contra la altitud y la temperatura simultáneamente. En este caso la interaccion entre las dos covariables tiene una relacion lineal que esta dada por el valor de alpha3 = 0 que hemos establecido anteriormente.
</p>
</div>
<p>Hasta aca memos modelado los dos procesos el ecologico <span class="math inline">\(z\)</span> y el de observación <em>p</em> por aparte. Ahora tendremos que ponerlos juntos, y para esto multiplicamos el resultado del proceso ecologico por la probabilidad de deteccion dentro de una distribucion Bernoulli.</p>
<div id="uniendo-los-dos-procesos-el-ecologico-y-el-de-observacion" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Uniendo los dos procesos el ecologico y el de observación</h3>
<p>Cuando “medimos” la ocurrencia, la detección imperfecta, representa una fuente de error con una distribución de tipo Bernoulli (por ejemplo la presencia del venado en un sitio en que es detectado con una probabilidad <em>p</em>, o no es detectado como 1-<em>p</em>. Al aplicar este proceso de observación producimos medidas repetidas de la presencia o ausencia (1 o 0) del venado en cada sitio. Recuerde que la distribución Bernoulli es un caso especial de la distribución binomial, y su mejor ejemplo es el lanzamiento de una moneda una sola vez.</p>
<p>En este momento estamos estableciendo la jerarquia en el modelo jerarquico. Aca estamos anidando el proceso ecologico “dentro” del proceso de observación.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> M, <span class="dt">ncol =</span> J)      <span class="co"># Prepare array for counts</span>
for (i in <span class="dv">1</span>:J){                          <span class="co"># Generate counts</span>
   y[,i] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> M, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> z*p[,i])   <span class="co"># this is the Bernoulli</span>
}</code></pre></div>
<p>Hasta acá hemos simulado la presencia/ausencia del venado de cola blanca en 60 sitios durante 30 sesiones de muestreo. Veamos que contienen las tablas. Recuerde que los sitios están en las filas y los muestreos repetidos en las columnas. Para comparar, mostraremos la verdadera ocurrencia en la primera columna para 30 sitios y solo cinco muestreos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr)
<span class="kw">kable</span>(<span class="kw">as.data.frame</span>(<span class="kw">head</span>(<span class="kw">cbind</span>(<span class="st">&quot;True Presence/Absence&quot;</span> =<span class="st"> </span>z, 
           <span class="st">&quot;1st survey&quot;</span> =<span class="st"> </span>y[,<span class="dv">1</span>], 
           <span class="st">&quot;2nd survey&quot;</span> =<span class="st"> </span>y[,<span class="dv">2</span>], 
           <span class="st">&quot;3rd survey&quot;</span> =<span class="st"> </span>y[,<span class="dv">3</span>],
           <span class="st">&quot;4th survey&quot;</span> =<span class="st"> </span>y[,<span class="dv">4</span>],
           <span class="st">&quot;5th survey&quot;</span> =<span class="st"> </span>y[,<span class="dv">5</span>]), <span class="dv">30</span>)) )   <span class="co"># First 30 rows (= sites)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">True Presence/Absence</th>
<th align="right">1st survey</th>
<th align="right">2nd survey</th>
<th align="right">3rd survey</th>
<th align="right">4th survey</th>
<th align="right">5th survey</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Ahora finalmente visualizaremos graficamente los datos de unos y ceros que hemos simulado para nuestro muestreo. Recuerde que se trata de valores de unos que representan si hemos detectado, o no hemos detectado al venado, en cada uno de los sitios de muestreo en cada una de las visitas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">cex.main =</span> <span class="dv">1</span>)
<span class="kw">matplot</span>(elev, <span class="kw">jitter</span>(y), <span class="dt">pch =</span> <span class="st">&quot;*&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), 
        <span class="dt">xlab =</span> <span class="st">&quot;Altitud&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Detection/Nondetection (y)&quot;</span>)
<span class="kw">matplot</span>(forest, <span class="kw">jitter</span>(y), <span class="dt">pch =</span> <span class="st">&quot;*&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), 
        <span class="dt">xlab =</span> <span class="st">&quot;Forest cover&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Detection/Nondetection (y)&quot;</span>)
<span class="kw">matplot</span>(temp, <span class="kw">jitter</span>(y), <span class="dt">pch =</span> <span class="st">&quot;*&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), 
        <span class="dt">xlab =</span> <span class="st">&quot;Teperature&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Detection/Nondetection (y)&quot;</span>)
<span class="kw">hist</span>(y, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">600</span>), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, 
     <span class="dt">xlab =</span> <span class="st">&quot;Detection/Nondetection (y)&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:graph6"></span>
<img src="Simul-Machalilla-book_files/figure-html/graph6-1.png" alt="Relación entre la (jittered) ocupación observada de venados (y) y las tres covariables estandarizadas. Altitud (A). Cobertura de bosque (B). Temperatura (C) y la frecuencia de distribución de la ocurrencia observada (y) en un set de datos de 60 sitios con 30 muestreos cada uno (D)." width="672" />
<p class="caption">
Figure 5.5: Relación entre la (jittered) ocupación observada de venados (y) y las tres covariables estandarizadas. Altitud (A). Cobertura de bosque (B). Temperatura (C) y la frecuencia de distribución de la ocurrencia observada (y) en un set de datos de 60 sitios con 30 muestreos cada uno (D).
</p>
</div>
<p>Hasta aquí hemos creado un set de datos donde la detección/no detección del venado esta negativamente correlacionado con la temperatura y positivamente relacionado con la cobertura de bosque. Hay una razón por la cual esta correlación entre variables es diferente. La ocurrencia por sitio, el objetivo de la inferencia ecológica, está afectado por la cobertura de bosque y la altitud, pero no por la temperatura, mientras que la probabilidad de detección, el parámetro caracterizando la medida del proceso de error cuando tomamos medidas de ocurrencia, es también afectado por la altitud y adicionalmente por la temperatura. Por lo tanto, como se puede notar, hay un gran reto para poder desenredar la razón de la variación espacio-temporal en la observación de los datos de detección/no detección, dado que pueden ser afectados por dos procesos totalmente diferentes: el ecológico y el observacional, que tambien la misma covariable puede afectar los dos procesos y que tambien pueden existir interacciones entre covariables.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Kery2008">
<p>Kéry, M., and J. A. Royle. 2008. “Hierarchical Bayes estimation of species richness and occupancy in spatially replicated surveys.” <em>Journal of Applied Ecology</em> 45 (2): 589–98. doi:<a href="https://doi.org/10.1111/j.1365-2664.2007.01441.x">10.1111/j.1365-2664.2007.01441.x</a>.</p>
</div>
<div id="ref-KERY2008">
<p>Kéry, M. 2008. “Estimating abundance from bird counts: binomial mixture models uncover complex covariate relationships.” <em>The Auk</em> 125 (2). The American Ornithologists’ Union: 336–45. doi:<a href="https://doi.org/10.1525/auk.2008.06185">10.1525/auk.2008.06185</a>.</p>
</div>
<div id="ref-Kery2012">
<p>Kéry, Marc, and Michael Schaub. 2012. “Estimation of Occupancy and Species Distributions from Detection/Nondetection Data in Metapopulation Designs Using Site-Occupancy Models.” In <em>Bayesian Population Analysis Using WinBUGS</em>, 413–61. Elsevier. doi:<a href="https://doi.org/10.1016/B978-0-12-387020-9.00013-4">10.1016/B978-0-12-387020-9.00013-4</a>.</p>
</div>
<div id="ref-RCoreTeam2016">
<p>R Core Team. 2016. <em>R: A language and environment for statistical computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="http://www.r-project.org/" class="uri">http://www.r-project.org/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="la-ocupacion-de-habitat.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="empacando-todo-en-una-funcion-.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dlizcano/occu_book/edit/master/04-example.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
